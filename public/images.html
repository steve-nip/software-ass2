<!DOCTYPE html>
<html lang="en">

<head>
    <title>Image AI Dataset Annotation</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
       <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
     <link rel="stylesheet" href="style.css">
</head>

<body>
    
    <div class="container">
        <h1 id="main-title" class="mt-5 mb-3">
            <i class="bi bi-image"></i> View Images
        </h1>

        <main>

            <nav aria-label="breadcrumb" class="mb-4">
                <ol class="breadcrumb">
                    <ul>
                        <li class="breadcrumb-item"><a href="index.html"><i class="bi bi-house-door"></i> Home</a></li>
                        <li class="breadcrumb-item"><a href="upload.html"><i class="bi bi-cloud-upload"></i> Upload Image</a></li>
                        <li class="breadcrumb-item"><a href="labels.html"><i class="bi bi-tags"></i> Manage Labels</a></li>
                        <li class="breadcrumb-item"><a href="images.html"><i class="bi bi-image"></i> Manage Images</a></li>
                    </ul>

                 
                </ol>
            </nav>


            <section class="card mb-5 shadow-sm">
                <div class="card-body p-4">
                    <p class="lead text-muted mb-4">
                        Browse uploaded images, review labels coverage, and open individual images to annotate further.
                    </p>
                    <h2 class="mb-4"><i class="bi bi-collection"></i> Images Gallery</h2>
                    <div id="status"></div>

                    <ul class="data-list" id="image-items"></ul>
                </div>
            </section>
        </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

   <script>
    const listEl = document.getElementById('image-items');
    const statusEl = document.getElementById('status');

    async function loadImages() {
        listEl.innerHTML = '';
        statusEl.innerHTML = '<span class="spinner-border spinner-border-sm me-2"></span>Loading images...';
        statusEl.className = 'alert alert-info';

        try {
            const response = await fetch('/api/images');
            const data = await response.json();
            if (!response.ok) {
                throw new Error(data.error || 'Failed to load images');
            }
            if (!data.images || data.images.length === 0) {
                statusEl.innerHTML = /*html*/ `No images uploaded yet. <a href="upload.html">Upload one now</a>`;
                return;
            }

            statusEl.textContent = `Total ${data.images.length} images`;
            for (const image of data.images) {
                const item = document.createElement('li');
                item.className = 'data-item mb-3 p-3 border rounded';
                item.innerHTML = /*html*/ `
                <a href="image.html?id=${encodeURIComponent(image.id)}" class="list-link images-item">
                        <img
                     src="/uploads/${encodeURIComponent(image.filename)}" 
                     alt="Preview of ${(image.filename)}"                 
                     class="thumbnail"
                     loading="lazy"
                        >
                     <span class="image-meta">
                     <span class="primary">${image.filename}</span>
                     <span class="secondary">
                        Uploaded on ${new Date(image.upload_time).toLocaleString()}. ${image.labels_count} labels
                      </span>
                     </span>
                </a>
                `;
                listEl.appendChild(item);
            }
        } catch (error) {
            statusEl.textContent = error instanceof Error ? error.message : String(error);
            statusEl.className = 'alert alert-danger';
        }
    }

    loadImages();
</script>
</body>

</html>
<!DOCTYPE html>